<!DOCTYPE html>
<html>
<script type="text/javascript" src="game.js"></script>
<script type="text/javascript" src="../../maze generation algorithms/scripts/maze.js"></script>

<head>
    <meta charset="utf-8" />
    <title>Maze Shooter</title>
    <style>
        * {
            padding: 0;
            margin: 0;
        }

        canvas {
            background: #eee;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>

<body>
    </br>
    <canvas oncontextmenu="move()" onclick="shoot()" id="myCanvas" width="2001" height="2001"></canvas>

    <script>
        mazeSize = 100;
        mazeComplexity = .75;
        mazeDensity = 0.3;
        removeStragglers = true;
        maze = makeMaze(mazeSize, mazeSize, mazeComplexity, mazeDensity, removeStragglers);
        wallsO = mazePoints(maze);

        var canvas = document.getElementById('myCanvas');
        var ctx = canvas.getContext('2d');

        count = 0;
        turn = true;


        function getMousePos(canvas, evt) {
            var rect = canvas.getBoundingClientRect();
            return {
                x: evt.clientX - rect.left,
                y: evt.clientY - rect.top
            };

        }

        function shoot() {
            if (bullet == false) {
                turn = !turn
                mousePosition = getMousePos(canvas, event);
                dx = (mousePosition.x - x);
                dy = (mousePosition.y - y);
                angle = Math.atan2(dy, dx);
                bullet = true;
            }
        }

        function move() {
            if(bullet) {return;}
            if (count <= 3) {
                playerMousePosition = getMousePos(canvas, event);
                playerDx = (playerMousePosition.x - currentPlayerX);
                playerDy = (playerMousePosition.y - currentPlayerY);
                playerAngle = Math.atan2(playerDy, playerDx);

                if (turn) {
                    playerPosition[0] += Math.cos(playerAngle) * 100 * speed;
                    playerPosition[1] += Math.sin(playerAngle) * 100 * speed;
                    currentPlayerX = playerPosition[0];
                    currentPlayerY = playerPosition[1];


                } else {
                    player2Position[0] += Math.cos(playerAngle) * 100 * speed;
                    player2Position[1] += Math.sin(playerAngle) * 100 * speed;
                    currentPlayerX = player2Position[0];
                    currentPlayerY = player2Position[1];
                }

                x = currentPlayerX;
                y = currentPlayerY;

            } else {
                alert("next players turn")
                turn = !turn;
                count = 0
            }
        }


        game(canvas, ctx, wallsO)
    </script>

</body>

</html>